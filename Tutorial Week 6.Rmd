---
title: "Rural Windfall or a New Resource Curse? Coca, Income, and Civil Conflict in Colombia"
subtitle: "Based on Angrist & Kugler (2008)"
author: "Group Members: [Name 1], [Name 2], [Name 3]"
date: "`r Sys.Date()`"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    code_folding: show
    theme: flatly
  github_document:
    toc: true
    html_preview: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, 
                      fig.width = 10, fig.height = 6)
```

# Load Packages

```{r load-packages}
library(tidyverse)    # Data manipulation and visualization
library(haven)        # Reading data files
library(knitr)        # Tables
library(kableExtra)   # Enhanced tables
library(broom)        # Tidy regression output
library(lmtest)       # Hypothesis testing
library(car)          # Linear hypothesis tests
library(gridExtra)    # Multiple plots
```

# Load Data

```{r load-data}
# Read the dataset
data <- read_delim("data00_AngristKugler.tab", delim = "\t")

# Display structure
glimpse(data)
```

---

# Q1. Setup and Data Construction

**Tasks:**

1. Subset data to years 1991, 1992, 1993 and 1996, 1997, 1998
2. Create `grow` variable (1 if dep_ocu in {13, 18, 19, 50, 52, 86, 95, 97, 99}, 0 otherwise)
3. Create `after` variable (1 if year âˆˆ {1996, 1997, 1998}, 0 otherwise)
4. Create `growafter` variable (grow Ã— after)
5. Create outcome variable: $\log\left(\frac{populati+1}{violent+1}\right)$

```{r q1-data-setup}
# Subset to relevant years


# Create grow variable


# Create after variable


# Create growafter interaction


# Create outcome variable


# Confirm variable creation

```

---

# Q2. Visualizing Violence Before and After

**Tasks:**

1. Create density plots for non-growing vs. growing regions, before vs. after
2. Extend to 2Ã—2 grid by gender (men: sex=1, women: sex=2)
3. Interpret: Evidence of shifts in violence? Different by gender?

```{r q2-density-plots-simple}
# Density plots: Non-growing vs. Growing regions

```

```{r q2-density-plots-gender}
# 2x2 grid: Top=men, Bottom=women; Left=non-growing, Right=growing

```

**Interpretation:**

[Your interpretation here]

---

# Q3. Age-Specific Effects

**Task:** For coca-growing regions only, plot the change in outcome (after - before) by age group.

```{r q3-age-effects}
# Calculate mean difference by age for growing regions only


# Plot age-specific effects

```

**Interpretation:**

[Does the effect vary by age?]

---

# Q4. Testing the Parallel Trends Assumption (Pre-Treatment)

**Tasks:**

1. Use pre-treatment years (1990-1993)
2. Estimate: outcome = Î± + Î²Â·year + Î³Â·grow + Î´Â·(growÃ—year) + u
3. Test if growÃ—year interactions are jointly zero (year as linear and categorical)
4. Create graph of average outcome by year and group

```{r q4-prepare-data}
# Subset to pre-treatment years (1990-1993)

```

```{r q4-parallel-trends-linear}
# Model with year as linear

```

```{r q4-parallel-trends-categorical}
# Model with year as categorical (factor)

```

```{r q4-joint-test}
# Test if growÃ—year interactions are jointly zero

```

```{r q4-visual-trends}
# Graph: Average outcome by year and group

```

**Interpretation:**

[What do the p-values tell us about parallel trends?]

---

# Q5. Placebo DiD Test ðŸ§ 

**Tasks:**

1. Create placebo_after (1 if year=1992 or 1993, 0 if year=1990 or 1991)
2. Estimate placebo DiD model
3. Interpret placebo_after Ã— grow coefficient

```{r q5-placebo-data}
# Subset and create placebo variables

```

```{r q5-placebo-regression}
# Estimate placebo DiD model

```

**Interpretation:**

[Should the placebo effect be significant? What would significance suggest?]

---

# Q6. Covariate Balance at Time 0

**Task:** Compare treatment and control regions on age, sex, and populati using pre-treatment data.

```{r q6-balance-table}
# Create balance table

```

```{r q6-balance-plot}
# Optional: Standardized difference plot

```

**Discussion:**

[Why is covariate balance critical? What would imbalance imply?]

---

# Q7. Why Covariate Balance Matters

**Discussion Questions:**

1. If covariates are balanced at time 0, what does this imply about confounding?
2. What role do these variables play after assignment?
3. If violence trends already differ before treatment, how might this bias DiD?

[Your answers here]

---

# Q8. Covariate Timing and Post-Treatment Bias

**Discussion Questions:**

1. Should we include covariates from time 0, time 1, or both?
2. What happens if you include a covariate measured after treatment?
3. When might adjusting for post-treatment variables be appropriate?

[Your answers here]

---

# Q9. Computing the DiD Estimate

**Task:** Compute manual DiD estimate.

```{r q9-manual-did}
# Mean difference (after - before) for grow=1


# Mean difference (after - before) for grow=0


# DiD estimate: subtract the two

```

**Interpretation:**

[Why is DiD preferable to simple before-after comparison?]

---

# Q10. Regression Form of DiD

**Tasks:**

1. Estimate: outcome = Î²â‚€ + Î²â‚Â·after + Î²â‚‚Â·grow + Î²â‚ƒÂ·(afterÃ—grow) + u
2. Report Î²â‚ƒ and p-value
3. Show analytically that Î²â‚ƒ equals the manual DiD estimate

```{r q10-did-regression}
# DiD regression model

```

**Interpretation:**

[What does Î²â‚ƒ tell us about the causal effect?]

**Analytical proof:**

[Show that Î²â‚ƒ = (È²â‚,â‚ - È²â‚,â‚€) - (È²â‚€,â‚ - È²â‚€,â‚€)]

---

# Q11. Adding Covariates

**Task:** Estimate three models and compare.

```{r q11-model1}
# Model 1: outcome ~ grow + after + growafter

```

```{r q11-model2}
# Model 2: Add age and sex

```

```{r q11-model3}
# Model 3: Add age, sex, and populati

```

```{r q11-comparison}
# Compare models

```

**Discussion:**

[Does Î²â‚ƒ change? Do covariates matter? Which specification is most credible?]

---

# Q12. Interpretation and Reflection

**Summary:**

1. Did violence increase or decrease after the air-bridge disruption?
2. Does the evidence support a "resource-curse" interpretation?
3. What are the remaining identification threats?

[Your final interpretation here]

---

# Session Info

```{r session-info}
sessionInfo()
```
